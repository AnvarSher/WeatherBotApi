# WeatherBotApi

В данном репозитории расположено тестовое приложение реализующее API для telegram bot-а,
который выдает информацию о погоде в указанной локации.

Бот распознает текстовую информацию и воспринимает ее в качестве названия локации.
Бот так же распознает переданную в сообщении геолокацию.

Сервис реализован с использованием django rest framework.

## Установка и настройка

### Шаг 1. Клонируйте репозиторий
```
$ git clone https://github.com/AnvarSher/WeatherBotApi.git
```

### Шаг 2. Запустите контейнеры

> При необходимости изменить порт web приложения в файле docker-compose.yaml. По умолчанию установлен порт 8000.

```
$ docker-compose up -d --build
```

### Шаг 3. Подвяжите webhook бота

Выполните GET запрос по адресу: https://api.telegram.org/bot(Token)/setWebhook?url=https://(Domen or IP-address)/api/bot/.
Затем попробуйте написать боту сообщение или отправить ему локацию.

## Настройки

Все системные переменные сервиса вынесены в файл botenv.dev.


## Данные

Cхему данных можно подсмотреть в файле database-diagram.png. Тут всего три объекта.

Client - данные пользователя telegram, который обращается к боту.

Weather - информация о погоде в определенной точке на определенный момент времени.

ClientRequest - информация о запросе клиента, если это текстовый запрос, то текст запроса,
если это локация - то координаты. 
Если запрос выполнен успешно, то ClientRequest будет привязан к Weather.
Если запрос выполнен не успешно, ошибку можно будет увидеть в поле error объекта ClientRequest.